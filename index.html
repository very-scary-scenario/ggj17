<!doctype html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <link href="https://fonts.googleapis.com/css?family=Rum+Raisin" rel="stylesheet"/>
    <title>Idol Threat</title>
    <link rel="stylesheet" href="style.css"/>
    <link rel="apple-touch-icon" href="icon.png" />

    <meta name="mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-capable" content="yes"/>

    <meta name="apple-mobile-web-app-status-bar-style" content="white"/>

    <script>
      var PARTS;
      var PART_INDEX;
      var BIOS;
      var QUOTES;
      var ABILITIES;
      var ANIMATIONS;
    </script>
  </head>
  <body class="nothing-scanned">
    <header id="title">
      <h1>Idol Threat</h1>
      <p id="loading">You need to turn Javascript on to play</p>
      <script>
        document.getElementById('loading').innerText = 'Loading…';
      </script>
    </header>

    <section id="catalog">
    </section>

    <section id="unit" class="empty">
    </section>

    <section id="idol-detail">
    </section>

    <section id="battle">
    </section>

    <input type="file" accept="image/*" capture="camera" id="barcode-image"/>

    <script id="catalog-template" type="text/x-handlebars-template">
      <ul class="catalog">
        {{#each catalog}}
          <li data-index="{{@index}}" class="{{#if isInUnit}}active{{/if}}">
            <div class="portrait">
              {{{thumbSpriteHTML}}}
            </div>
            <div class="deets">
              <p class="name">{{name}}</p>
              <dl>
                <dt>Atk.</dt>
                <dd>{{attack}} +{{attackBonus}}</dd>
                <dt>Def.</dt>
                <dd>{{defense}} +{{defenseBonus}}</dd>
                <dt>Spd.</dt>
                <dd>{{speed}} +{{speedBonus}}</dd>
                <dt>End.</dt>
                <dd>{{endurance}} +{{enduranceBonus}}</dd>
              </dl>
            </div>
            <div data-index="{{@index}}" class="input {{#if isInUnit}}checked{{/if}}"/>
          </li>
        {{/each}}
      </ul>
      
      <p><a href="#" class="needsclick" id="recruit">Scan a barcode to recruit a new member…</a></p>
      {{#if catalog}}
        <p><a href="#" id="fight">Quick battle!</a></p>
      {{/if}}
    </script>

    <script id="idol-detail-template" type="text/x-handlebars-template">
      <div class="portrait">
        {{{spriteHTML}}}
      </div>
      <div class="summary bubble">
				<h2 class="name">{{name}}</h2>
        <div class="stats">
          <dl>
            <dt>Attack</dt>
            <dd>{{attack}} +{{attackBonus}}</dd>
            <dt>Defense</dt>
            <dd>{{defense}} +{{defenseBonus}}</dd>
            <dt>Speed</dt>
            <dd>{{speed}} +{{speedBonus}}</dd>
            <dt>Endurance</dt>
            <dd>{{endurance}} +{{enduranceBonus}}</dd>
          </dl>
        </div>
        <div class="abilities">
          <ul>
            {{#each abilities}}<li>{{name}}</li>{{/each}}
          </ul>
        </div>
      </div>
      <div class="bubble bio">
        <p>{{bio}}</p>
        <blockquote>“{{quote}}”</blockquote>
      </div>
      <div class="bubble controls">
        <a class="close" href="#">close</p>
      </div>
    </script>

    <script id="unit-template" type="text/x-handlebars-template">
      <h2>Your unit</h2>
      <ul class="unit">
        {{#each unit}}
          <li>
            <div class="portrait">
              {{{thumbSpriteHTML}}}
            </div>
          </li>
        {{/each}}
      </ul>
    </script>

    <script id="sprite-template" type="text/x-handlebars-template">
      <div class="sprite">
        {{#each parts}}
          <img class="needsclick layer-{{layer}}" data-thumb="{{../thumb}}" src="{{#if ../thumb}}{{thumbPath}}{{else}}{{medPath}}{{/if}}"/>
        {{/each}}
      </div>
    </script>

    <script id="battle-template" type="text/x-handlebars-template">
      <form id="battle-form">
        <ul class="idol-list" id="enemy-idols">
          {{#each enemyIdols}}
            <li data-index="{{@index}}">
              <label>
                <input required type="radio" name="target" value="{{@index}}"></input>
                <div class="portrait">
                  {{{thumbSpriteHTML}}}
                </div>
                {{{healthBar}}}
              </label>
            </li>
          {{/each}}
        </ul>

        <div id="ability-prompt">
        </div>

        <ul class="idol-list" id="player-idols">
          {{#each playerIdols}}
            <li data-index="{{@index}}">
              <div class="portrait">
                {{{thumbSpriteHTML}}}
              </div>
              {{{healthBar}}}
            </li>
          {{/each}}
        </ul>
      </form>
    </script>

    <script id="health-bar-template" type="text/x-handlebars-template">
      <div class="health-bar">
        <div class="health-bar-content" style="width: {{healthPercent}}%;"></div>
        <div class="health-bar-trail" style="width: {{healthPercent}}%;"></div>
      </div>
    </script>

    <script id="ability-prompt-template" type="text/x-handlebars-template">
      <p>What will {{idol.name}} do?</p>

      <ul>
        {{#each abilities}}
          <li>
            <label><input required type="radio" name="move" value="{{@index}}"/>{{name}}</label>
          </li>
        {{/each}}

        <input type="hidden" name="move" value="{{@index}}"/>
      </ul>

      <p>Also, pick a target from the enemy unit.</p>

      <button type="subit">Fight!</button>
    </script>

    <script src="fastclick.js"></script>
    <script src="quagga.min.js"></script>
    <script src="handlebars.min.js"></script>
    <script src="parts.js"></script>
    <script src="battle.js"></script>
    <script src="game.js"></script>
  </body>
</html>
